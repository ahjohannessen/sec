<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-types">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Basic Data Types | Scala KurrentDB Client</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ahjohannessen.github.com/sec/docs/types"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Basic Data Types | Scala KurrentDB Client"><meta data-rh="true" name="description" content="In sec some basic data types surface in many use cases when interacting with KurrentDB. In order to establish some basics"><meta data-rh="true" property="og:description" content="In sec some basic data types surface in many use cases when interacting with KurrentDB. In order to establish some basics"><link data-rh="true" rel="icon" href="/sec/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ahjohannessen.github.com/sec/docs/types"><link data-rh="true" rel="alternate" href="https://ahjohannessen.github.com/sec/docs/types" hreflang="en"><link data-rh="true" rel="alternate" href="https://ahjohannessen.github.com/sec/docs/types" hreflang="x-default"><link rel="stylesheet" href="/sec/assets/css/styles.4232e326.css">
<link rel="preload" href="/sec/assets/js/runtime~main.f7a5b9f2.js" as="script">
<link rel="preload" href="/sec/assets/js/main.12edf8da.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?e("light"):e("dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sec/"><div class="navbar__logo"><img src="/sec/img/logo.svg" alt="sec" class="themedImage_ToTc themedImage--light_HNdA"><img src="/sec/img/logo.svg" alt="sec" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"> </b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sec/docs">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ahjohannessen/sec" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sec/docs/">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/sec/docs/types">Types and API</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sec/docs/types">Data Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sec/docs/client_api">Client API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sec/docs/config">Config</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sec/docs/writing">Streams</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sec/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Types and API</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Data Types</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Basic Data Types</h1></header><p>In sec some basic data types surface in many use cases when interacting with KurrentDB. In order to establish some basics
these are described in the following - More details about the particulars of these types are in API documentation.  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="streamid">StreamId<a href="#streamid" class="hash-link" aria-label="Direct link to StreamId" title="Direct link to StreamId">​</a></h3><p>Streams in KurrentDB have stream identifiers that can be classified as user defined and system defined.
In KurrentDB streams prefixed with <code>$</code> are reserved for the system, for instance <code>$settings</code>.
Furthermore, KurrentDB also has a concept of metadata streams for streams. Metadata streams for system streams are prefixed
with <code>$$</code>, e.g. the corresponding metadata stream for <code>$settings</code> is <code>$$$settings</code>. Metadata streams for user defined
streams are prefixed with a <code>$</code>, e.g. <code>user_stream</code> has a corresponding metadata stream named <code>$user_stream</code>.</p><p>In sec a stream identifier is an ADT called <code>StreamId</code> with variants <code>Id</code> and <code>MetaId</code> - <code>Id</code>
has two variants, <code>Normal</code> and <code>System</code>. The stream identifiers that a user can create are <code>Normal</code> and <code>System</code>,
this is done with <code>StreamId.apply</code> that returns an <code>Either[InvalidInput, Id]</code>. Some examples of <code>StreamId</code> construction
are:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214)">sec</span><span class="token namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StreamId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">val</span><span class="token plain"> user   </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;user_stream&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Right(Normal(&quot;user_stream&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">val</span><span class="token plain"> system </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;$system_stream&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Right(System(&quot;system_stream&quot;))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// MetaId for above you get from the metaId method.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// The render method displays the stream identifier as KurrentDB sees it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">metaId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Right(&quot;$$user_stream&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">system</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">metaId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Right(&quot;$$$system_stream&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Invalid stream identifiers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Left(InvalidInput(&quot;id cannot be empty&quot;))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;$$oops&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Left(InvalidInput(&quot;value must not start with $$, but is $$oops&quot;))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Moreover, a few common system stream identififiers are located in the <code>StreamId</code> companion object, for instance:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214)">sec</span><span class="token namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StreamId</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">All</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render               </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Scavenges</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render         </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $scavenges</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">All</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">metaId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $$$all</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Scavenges</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">metaId</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $$$scavenges</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="streamposition">StreamPosition<a href="#streamposition" class="hash-link" aria-label="Direct link to StreamPosition" title="Direct link to StreamPosition">​</a></h3><p>When you store an event in KurrentDB it is assigned a <strong>stream position</strong> in the individual stream it belongs to.
In sec a stream position is an ADT called <code>StreamPosition</code> with two variants, <code>StreamPosition.Exact</code> that contains
a <code>Long</code> and <code>StreamPosition.End</code> that is an object representing the end of a stream.</p><p>A <code>StreamPosition</code> that you can create is <code>Exact</code> and this is done with <code>StreamPosition.apply</code> that returns an
<code>Exact</code>. Examples of <code>StreamPosition</code> construction:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214)">sec</span><span class="token namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StreamPosition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Start </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Exact(0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1L</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Exact(1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">StreamPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">End   </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// End</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>One use case where you need to construct a <code>StreamPosition</code> is when you to store a pointer of the last processed
event for a particular stream as a <code>Long</code> in a read model and, e.g. after a restart of your application,
need to resume reading from KurrentDB.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="logposition">LogPosition<a href="#logposition" class="hash-link" aria-label="Direct link to LogPosition" title="Direct link to LogPosition">​</a></h3><p>All events in KurrentDB have a logical position in the global transaction log. A logical position consists of a <em>commit position</em> value
and a <em>prepare position</em> value. In sec this is modelled as an ADT called <code>LogPosition</code> with two variants, <code>LogPosition.Exact</code>
that contains two <code>Long</code> values and <code>LogPosition.End</code> representing the end of the log.</p><p>A <code>LogPosition</code> that you can create from <code>Long</code> values is <code>Exact</code>, this is done with <code>LogPosition.apply</code> that returns an
<code>Either[InvalidInput, Exact]</code>. Examples of <code>LogPosition</code> construction:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214)">sec</span><span class="token namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">LogPosition</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LogPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Start    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Exact(0, 0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LogPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">End      </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// End</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LogPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1L</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1L</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Right(Exact(1, 1))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">LogPosition</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0L</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1L</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Left(InvalidInput(&quot;commit must be &gt;= prepare, but 0 &lt; 1&quot;))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Cases where you construct a <code>LogPosition</code> is similar to that of <code>StreamPosition</code>, maintaining a pointer of last
processed event. However, here you keep a pointer to the global log, <code>StreamId.All</code>, instead of an individual
stream.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-note-on-long-usage-in-positions">A note on <code>Long</code> usage in positions<a href="#a-note-on-long-usage-in-positions" class="hash-link" aria-label="Direct link to a-note-on-long-usage-in-positions" title="Direct link to a-note-on-long-usage-in-positions">​</a></h3><p>KurrentDB uses <code>uint64</code> that Java does not have a corresponding type for. In order to work around that fact sec has a
type called <code>ULong</code> that is able to represent <code>uint64</code> by wrapping a regular <code>Long</code> and use this for <code>StreamPosition.Exact</code>
and <code>LogPosition.Exact</code>. As sec provides an instance of <code>cats.Order</code> for <code>ULong</code> it is possible to compare positions larger than <code>Long.MaxValue</code> as well as positions in <code>[0, Long.MaxValue]</code>.</p><p>Moreover, this means that you can store a <code>LogPosition.Exact</code> pointer for your read model by using <code>toLong</code> on its <code>ULong</code> values. The <code>ULong.toLong</code> method might yield negative values, this is fine as when <code>LogPosition.Exact</code> is constructed again it has an <code>cats.Order</code> instance that works for all numbers in <code>uint64</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="streamstate">StreamState<a href="#streamstate" class="hash-link" aria-label="Direct link to StreamState" title="Direct link to StreamState">​</a></h3><p>Some operations, such as appending events to a stream, require that you provide an <em>expectation</em> of what <strong>state</strong>
the stream currently is in. If the stream state does not fullfil that expectation then an exception will be raised by KurrentDB.
In sec this expected stream state is represented by the ADT <code>StreamState</code> that has four variants:</p><ul><li><code>NoStream</code> - The stream does not exist yet. </li><li><code>Any</code> - No expectation about the current state of the stream.</li><li><code>StreamExists</code> - The stream, or its metadata stream, is present.</li><li><code>StreamPosition.Exact</code> - The stream exists and its last written stream position is expected to be <code>Exact</code>.</li></ul><p>The <code>StreamState</code> expectation can be used to implement optimistic concurrency. When you retrieve a stream from KurrentDB,
you can take note of the current stream position, then when you append to the stream you can determine if the stream has
been modified in the meantime.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="eventdata">EventData<a href="#eventdata" class="hash-link" aria-label="Direct link to EventData" title="Direct link to EventData">​</a></h3><p>The event data you store in KurrentDB is composed of an event type, an event id, payload data, metadata and a content type.
In sec this is modelled as <code>EventData</code> with types that are explained below.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="eventtype">EventType<a href="#eventtype" class="hash-link" aria-label="Direct link to EventType" title="Direct link to EventType">​</a></h4><p>An event type should be supplied for your event data. This is a unique string used to identify the type of event you are
saving. One might be tempted to use language runtime types for event types as it might make marshalling more convenient.
However, this is not recommended as it couples storage to your types. Instead, you can use a mapping between event
types stored in KurrentDB and your concrete runtime types.</p><p>The string that KurrentDB uses for the event type is modelled in sec as an ADT with two main variants
<code>Normal</code> and <code>System</code>. The type that you can create is <code>Normal</code> and this is done with <code>EventType.apply</code>
that returns <code>Either[InvalidInput, Normal]</code>. Input is validated for emptiness and not starting with <code>$</code> that KurrentDB
uses for reserved system defined types such as <code>$&gt;</code> and <code>$metadata</code>.</p><p>Examples of <code>EventType</code> construction:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214)">sec</span><span class="token namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">EventType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;foo.bar.baz&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Right(Normal(&quot;foo.bar.baz&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">            </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Left(InvalidInput(&quot;Event type name cannot be empty&quot;))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;$@&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// Left(InvalidInput(&quot;value must not start with $, but is $@&quot;))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Common system types are located in the companion of <code>EventType</code>, some examples are:</p><div class="language-scala codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-scala codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> </span><span class="token namespace" style="color:rgb(178, 204, 214)">sec</span><span class="token namespace punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">EventType</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">LinkTo</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render          </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StreamMetadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $metadata</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">Settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render        </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">EventType</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">StreamReference</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">render </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">// $@</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="eventid">EventId<a href="#eventid" class="hash-link" aria-label="Direct link to EventId" title="Direct link to EventId">​</a></h4><p>The format of an event identifier is a <em><a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" target="_blank" rel="noopener noreferrer">uuid</a></em> and is
used by KurrentDB to uniquely identify the event you are trying to append. If two events with the same uuid are appended to
the same stream in quick succession KurrentDB only appends one copy of the event to the stream. More information about this
is in the KurrentDB <a href="https://docs.kurrent.io/clients/grpc/appending-events.html#working-with-eventdata" target="_blank" rel="noopener noreferrer">docs</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="data">Data<a href="#data" class="hash-link" aria-label="Direct link to Data" title="Direct link to Data">​</a></h4><p>The <code>data</code> field on <code>EventData</code> is a <a href="https://github.com/scodec/scodec-bits" target="_blank" rel="noopener noreferrer">scodec</a> <code>ByteVector</code> encoded representation
of your event data. If you store your data as JSON you can make use of KurrentDB functionality for projections.
However, it is also common to store data in a <a href="https://developers.google.com/protocol-buffers" target="_blank" rel="noopener noreferrer"><code>protocol buffers</code></a> format.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="metadata">Metadata<a href="#metadata" class="hash-link" aria-label="Direct link to Metadata" title="Direct link to Metadata">​</a></h4><p>It is common to store additional information along side your event data. This can be correlation id, timestamp, audit,
marshalling info and so on. KurrentDB allows you to store a separate byte array containing this information to keep data
and metadata separate. These extra bytes are stored in a <code>ByteVector</code> field of <code>EventData</code> called <code>metadata</code>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="contenttype">ContentType<a href="#contenttype" class="hash-link" aria-label="Direct link to ContentType" title="Direct link to ContentType">​</a></h4><p>The <code>data</code> and <code>metadata</code> fields on <code>EventData</code> have a content type, <code>ContentType</code>, with
variants <code>Binary</code> and <code>Json</code>. This is used to provide KurrentDB information about whether the data is stored as json or as
binary. As you might have noticed, both <code>ByteVector</code> fields of <code>EventData</code> share the same content type, this is because
KurrentDB does not support different content types for <code>data</code> and <code>metadata</code>.</p><p>When <code>EventType</code> is translated to the protocol of KurrentDB it becomes <code>application/octet-stream</code> for <code>Binary</code> and
<code>application/json</code> for <code>Json</code>. In the future there might come more content types, e.g. something that corresponds to
<code>application/proto</code> or <code>application/avro</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="event">Event<a href="#event" class="hash-link" aria-label="Direct link to Event" title="Direct link to Event">​</a></h3><p>Event data arriving from KurrentDB either comes from an individual stream or from the global log. An event is encoded as an
<code>ADT</code> called <code>Event</code> that has the variants <code>EventRecord</code> and <code>ResolvedEvent</code>.</p><p>An <code>EventRecord</code> consists of the following data types:</p><ul><li><code>streamId: StreamId</code> - The stream the event belongs to.</li><li><code>streamPosition: StreamPosition.Exact</code> - The stream position of the event in its stream.</li><li><code>logPosition: LogPosition.Exact</code> - The position of the event in the global stream.</li><li><code>eventData: EventData</code> - The data of the event.</li><li><code>created: ZonedDateTime</code> - The time the event was created.</li></ul><p>A <code>ResolvedEvent</code> is used when consuming streams that link to other streams. It consists of:</p><ul><li><code>event: EventRecord</code> - The linked event.</li><li><code>link: EventRecord</code> - The linking event record.</li></ul><p>See the API docs for various methods defined for <code>Event</code>.</p><p>Later on when using the <a href="/sec/docs/client_api">EsClient API</a>, you will learn about reading from streams and instruct KurrentDB to
resolve links such that you get events of type <code>ResolvedEvent</code> back.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/sec/docs/setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Quick Start</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sec/docs/client_api"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Client API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#streamid" class="table-of-contents__link toc-highlight">StreamId</a></li><li><a href="#streamposition" class="table-of-contents__link toc-highlight">StreamPosition</a></li><li><a href="#logposition" class="table-of-contents__link toc-highlight">LogPosition</a></li><li><a href="#a-note-on-long-usage-in-positions" class="table-of-contents__link toc-highlight">A note on <code>Long</code> usage in positions</a></li><li><a href="#streamstate" class="table-of-contents__link toc-highlight">StreamState</a></li><li><a href="#eventdata" class="table-of-contents__link toc-highlight">EventData</a></li><li><a href="#event" class="table-of-contents__link toc-highlight">Event</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025, sec contributors.</div></div></div></footer></div>
<script src="/sec/assets/js/runtime~main.f7a5b9f2.js"></script>
<script src="/sec/assets/js/main.12edf8da.js"></script>
</body>
</html>